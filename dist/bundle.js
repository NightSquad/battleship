(()=>{"use strict";const e=new class{success(e){let t=document.getElementsByClassName("modal")[0],o=document.createElement("div");o.addEventListener("animationiteration",(e=>{o.style.animationPlayState="paused",setTimeout((()=>o.style.animationPlayState="running"),2e3)})),o.addEventListener("animationend",(e=>{o.remove()})),o.classList.add("notify"),o.style.backgroundColor="green";let d=document.createElement("p");d.textContent=e,o.append(d),t.prepend(o)}fail(e){let t=document.getElementsByClassName("modal")[0],o=document.createElement("div");o.addEventListener("animationiteration",(e=>{o.style.animationPlayState="paused",setTimeout((()=>o.style.animationPlayState="running"),2e3)})),o.addEventListener("animationend",(e=>{o.remove()})),o.classList.add("notify"),o.style.backgroundColor="brown";let d=document.createElement("p");d.textContent=e,o.append(d),t.prepend(o)}};let t=document.getElementsByClassName("playerBoard")[0],o=["А","Б","В","Г","Д","Е","Ж","З","И","К"],d=[],l=[];for(let e=0;e<10;e++){let n=document.createElement("div");n.className="line",n.id=e;let r={};d.push(r);for(let r=0;r<10;r++){let s=document.createElement("button");s.className="field",s.classList.add("droppable"),s.dataset.num=e,s.dataset.char=r,s.addEventListener("click",(function(o){console.log(e,r),l.some(((d,l)=>!!d.coord.some((t=>JSON.stringify(t)==JSON.stringify([e,r])))&&(d.hit(o),d.isSunk(),console.log(d.isSunk()),console.log(d.coord),d.isSunk()&&(d.coord.forEach((e=>{t.childNodes[e[0]].childNodes[e[1]].style.backgroundColor="green"})),t.childNodes[d.coord[0][0]-1]&&(t.childNodes[d.coord[0][0]-1].childNodes[d.coord[0][1]].style.backgroundColor="black"),t.childNodes[d.coord[d.coord.length-1][0]+1]&&(t.childNodes[d.coord[d.coord.length-1][0]+1].childNodes[d.coord[d.coord.length-1][1]].style.backgroundColor="black"),1==d.coord.length&&(t.childNodes[d.coord[0][0]].childNodes[d.coord[0][1]-1].style.backgroundColor="black",t.childNodes[d.coord[0][0]].childNodes[d.coord[0][1]+1].style.backgroundColor="black")),!0)))||(s.style.backgroundColor="black")})),n.append(s),d[e][o[r]]=o[r]}t.append(n)}class n{constructor(){this.coord=[]}hit=e=>{let o=parseInt(e.currentTarget.dataset.num,10),d=parseInt(e.currentTarget.dataset.char,10);e.currentTarget.style.backgroundColor="blue",t.childNodes[o-1]&&(t.childNodes[o-1].childNodes[d-1]&&(t.childNodes[o-1].childNodes[d-1].style.backgroundColor="black"),t.childNodes[o-1].childNodes[d+1]&&(t.childNodes[o-1].childNodes[d+1].style.backgroundColor="black")),t.childNodes[o+1]&&(t.childNodes[o+1].childNodes[d-1]&&(t.childNodes[o+1].childNodes[d-1].style.backgroundColor="black"),t.childNodes[o+1].childNodes[d+1]&&(t.childNodes[o+1].childNodes[d+1].style.backgroundColor="black"))};isSunk=()=>{let e=0;for(let o=0;o<this.coord.length;o++)"blue"==t.childNodes[this.coord[o][0]].childNodes[this.coord[o][1]].style.backgroundColor&&e++;return e==this.coord.length}}let r=null;function s(e){e.dataTransfer.effectAllowed="move",r=e.target}t.addEventListener("dragleave",(function(e){"red"!=e.target.style.backgroundColor&&(e.target.style.background="none")})),t.addEventListener("dragover",(function(e){e.preventDefault(),e.dataTransfer.dropEffect="move","red"!=e.target.style.backgroundColor&&(e.target.style.backgroundColor="pink")})),t.addEventListener("drop",(function(o){return o.preventDefault(),"horizontal"==r.classList[1]?function(o,d){let r=parseInt(o.target.dataset.num,10),s=parseInt(o.target.dataset.char,10);for(let t=0;t<3;t++)for(let o=0;o<d+2;o++)if(l.some((e=>(console.log(e.coord),e.coord.some((e=>JSON.stringify(e)==JSON.stringify([r-1+t,s-1+o])))))))return e.fail("Рядом есть другой корабль"),!1;if(!t.childNodes[r].childNodes[s+d-1])return e.fail("Корабль выходит за границы"),!1;let a=[];console.log(r,s+1);for(let e=0;e<d;e++)t.childNodes[r].childNodes[s+e].style.backgroundColor="red",a.push([r,s+e]);let c=new n;return c.coord=a,l.push(c),!0}(o,r.getElementsByTagName("button").length)?(r.remove(),void(r=null)):void 0:function(o,d){let r=parseInt(o.target.dataset.num,10),s=parseInt(o.target.dataset.char,10);for(let t=0;t<d+2;t++)for(let o=0;o<3;o++)if(l.some((e=>(console.log(e.coord),e.coord.some((e=>JSON.stringify(e)==JSON.stringify([r-1+t,s-1+o])))))))return e.fail("Рядом есть другой корабль"),!1;if(!t.childNodes[r+d-1])return e.fail("Корабль выходит за границы"),!1;let a=[];for(let e=0;e<d;e++)t.childNodes[r+e].childNodes[s].style.backgroundColor="red",a.push([r+e,s]);let c=new n;return c.coord=a,l.push(c),!0}(o,r.getElementsByTagName("button").length)?(r.remove(),void(r=null)):void 0}));let a=document.getElementsByClassName("submarine");for(let e=0;e<a.length;e++)a[e].addEventListener("dragstart",s),a[e].addEventListener("dblclick",(e=>{e.currentTarget.classList.toggle("horizontal")}))})();